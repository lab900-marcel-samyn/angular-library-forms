<div class="lab900-table {{tableClass}}" *ngIf="tableCells?.length">

  <lab900-table-header
      [tableHeaderActions]="tableHeaderActions"
      [tableCells]="tableCells"
      [toggleColumns]="toggleColumns"
  >
    <ng-container *ngIf="tableHeaderContent">
      <ng-container *ngTemplateOutlet="tableHeaderContent"></ng-container>
    </ng-container>
  </lab900-table-header>
  <table
    mat-table
    matSort
    class="mat-elevation-z0"
    *ngIf="(data?.length || neverHideTable) && !disabled"
    matSortDisableClear="true"
    [matSortActive]="activeSort?.active"
    [matSortDirection]="activeSort?.direction"
    [dataSource]="data"
    (matSortChange)="sort.emit($event)"
  >
    <ng-container matColumnDef="select">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let row">
        <mat-checkbox
          color="primary"
          (click)="$event.stopPropagation()"
          (change)="$event ? selectRow(row) : null"
          [checked]="selection.isSelected(row)"
          [disabled]="!selectEnabled"
        ></mat-checkbox>
      </td>
    </ng-container>

    <ng-container *ngFor="let cell of tableCells" [matColumnDef]="cell.key" [sticky]="cell?.sticky">
      <th mat-header-cell mat-sort-header [disabled]="!cell.sortable" *matHeaderCellDef="let element">{{ utils.getCellLabel(cell) | translate }}</th>
      <td [style.width]="cell?.width" mat-cell *matCellDef="let element"><span [className]="utils.getCellClass(element, cell)">{{ utils.getCellValue(element, cell) | translate }}</span></td>
    </ng-container>

    <ng-container matColumnDef="actions-front">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        <div style="width: 100%" fxLayout="row" fxLayoutGap="8" fxLayoutAlign="end center" *ngIf="tableActionsFront?.length">
          <lab900-table-action *ngFor="let action of tableActionsFront" [element]="element" [action]="action"></lab900-table-action>
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="actions-back" stickyEnd>
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        <div style="width: 100%" fxLayout="row" fxLayoutGap="8" fxLayoutAlign="end center" *ngIf="tableActionsBack?.length || tableActions?.length">
          <lab900-table-action *ngFor="let action of (tableActionsBack || tableActions)" [element]="element" [action]="action"></lab900-table-action>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

  <mat-paginator
      *ngIf="data?.length && paging"
      hidePageSize
      [length]="paging.totalItems"
      [pageSize]="paging.pageSize"
      [pageIndex]="paging.pageIndex"
      (page)="pageChange.emit($event)"
  ></mat-paginator>

  <div class="lab900-table__empty" *ngIf="data && !data.length && !disabled">
    <ng-container *ngIf="emptyTableTemplate">
      <ng-container *ngTemplateOutlet="emptyTableTemplate"></ng-container>
    </ng-container>
    <ng-container *ngIf="!emptyTableTemplate">
      <h3>{{'GENERAL.NO_RESULTS.TITLE' | translate}}</h3>
      <p>{{'GENERAL.NO_RESULTS.DESC' | translate}}</p>
    </ng-container>
  </div>

  <div *ngIf="disabled">
    <ng-container *ngIf="disabledTableTemplate">
      <ng-container *ngTemplateOutlet="disabledTableTemplate"></ng-container>
    </ng-container>
    <ng-container *ngIf="!disabledTableTemplate">
      <h3>{{'GENERAL.DISABLED.TITLE' | translate}}</h3>
      <p>{{'GENERAL.DISABLED.DESC' | translate}}</p>
    </ng-container>
  </div>

</div>
